Traceback (most recent call last):
  File "/home/danbot/code/data_analysis/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 154, in wrapped
    asyncio.get_running_loop()
RuntimeError: no running event loop

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/danbot/code/data_analysis/lib/python3.12/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/home/danbot/code/data_analysis/lib/python3.12/site-packages/nbclient/client.py", line 1319, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/danbot/code/data_analysis/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 158, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/home/danbot/code/data_analysis/lib/python3.12/site-packages/nbclient/client.py", line 709, in async_execute
    await self.async_execute_cell(
  File "/home/danbot/code/data_analysis/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/danbot/code/data_analysis/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
processed = []
t0 = time()
for stn in [s for s in context.official_ids if s in daymet_concurrent_stations]:
    if stn == '12414900': # this station has no data in the LSTM ensemble results
        print(f'    ...skipping {stn} due to naming issue.')
        continue
    print(f'Estimating FDC for {stn}...')
    runner = FDCEstimatorRunner(stn, context, methods, k_nearest, target_cols, ESTIMATOR_CLASSES)
    runner.run_selected()
    processed.append(stn)
    if len(processed) % 10 == 0:
        t1 = time()
        elapsed = t1 - t0
        unit_time = elapsed / len(processed)
        print(f'Processed {len(processed)}/{len(context.official_ids)} stations in {unit_time:.2f} seconds per station')
------------------

----- stdout -----
Estimating FDC for 05AA008...
Estimating FDC for 05AA022...
Estimating FDC for 05AA023...
Estimating FDC for 05AA035...
Estimating FDC for 05AD003...
Estimating FDC for 05BA001...
Estimating FDC for 05BB001...
Estimating FDC for 05BF016...
Estimating FDC for 05BF017...
Estimating FDC for 05BF018...
Processed 10/1097 stations in 0.00 seconds per station
Estimating FDC for 05BF019...
Estimating FDC for 05BG006...
Estimating FDC for 05BH015...
Estimating FDC for 05BJ004...
Estimating FDC for 05BJ010...
Estimating FDC for 05BL012...
Estimating FDC for 05BL014...
Estimating FDC for 05BL022...
Estimating FDC for 05CA009...
Estimating FDC for 05CB001...
Processed 20/1097 stations in 0.00 seconds per station
Estimating FDC for 05CB004...
Estimating FDC for 05CC001...
Estimating FDC for 05CC007...
Estimating FDC for 05DA007...
Estimating FDC for 05DA009...
Estimating FDC for 05DA010...
Estimating FDC for 05DB002...
Estimating FDC for 05DB006...
Estimating FDC for 05DC006...
Estimating FDC for 05DC012...
Processed 30/1097 stations in 0.00 seconds per station
Estimating FDC for 05DD009...
Estimating FDC for 07AA001...
Estimating FDC for 07AA002...
Estimating FDC for 07AD002...
Estimating FDC for 07AF002...
Estimating FDC for 07AG003...
Estimating FDC for 07AG007...
Estimating FDC for 07BB002...
Estimating FDC for 07BB003...
Estimating FDC for 07BC002...
Processed 40/1097 stations in 0.00 seconds per station
Estimating FDC for 07EA002...
Estimating FDC for 07EA004...
Estimating FDC for 07EA005...
Estimating FDC for 07EA007...
Estimating FDC for 07EB002...
Estimating FDC for 07EC002...
Estimating FDC for 07EC003...
Estimating FDC for 07EC004...
Estimating FDC for 07ED001...
Estimating FDC for 07ED003...
Processed 50/1097 stations in 0.00 seconds per station
Estimating FDC for 07EE007...
Estimating FDC for 07EE009...
Estimating FDC for 07EE010...
Estimating FDC for 07EF004...
Estimating FDC for 07FA003...
Estimating FDC for 07FA005...
Estimating FDC for 07FA006...
Estimating FDC for 07FB001...
Estimating FDC for 07FB002...
Estimating FDC for 07FB003...
Processed 60/1097 stations in 0.00 seconds per station
Estimating FDC for 07FB004...
Estimating FDC for 07FB005...
Estimating FDC for 07FB006...
Estimating FDC for 07FB008...
Estimating FDC for 07FB009...
Estimating FDC for 07FC001...
Estimating FDC for 07FC003...
Estimating FDC for 07FD001...
Estimating FDC for 07FD004...
Estimating FDC for 07FD007...
Processed 70/1097 stations in 0.00 seconds per station
Estimating FDC for 07GA001...
Estimating FDC for 07GA002...
Estimating FDC for 07GD001...
Estimating FDC for 07GD003...
Estimating FDC for 07GD004...
Estimating FDC for 07GE001...
Estimating FDC for 07GF001...
Estimating FDC for 07GG001...
Estimating FDC for 07GH002...
Estimating FDC for 07GJ001...
Processed 80/1097 stations in 0.00 seconds per station
Estimating FDC for 07HA005...
Estimating FDC for 07HC001...
Estimating FDC for 07OC001...
Estimating FDC for 07UC001...
Estimating FDC for 08AA008...
Estimating FDC for 08AA009...
Estimating FDC for 08AB001...
Estimating FDC for 08AB002...
Estimating FDC for 08AC001...
Estimating FDC for 08AC002...
Processed 90/1097 stations in 0.00 seconds per station
Estimating FDC for 08BB001...
Estimating FDC for 08BB005...
Estimating FDC for 08CA001...
Estimating FDC for 08CA002...
Estimating FDC for 08CA003...
Estimating FDC for 08CB001...
Estimating FDC for 08CC001...
Estimating FDC for 08CC002...
Estimating FDC for 08CC003...
Estimating FDC for 08CD001...
Processed 100/1097 stations in 0.00 seconds per station
Estimating FDC for 08CE001...
Estimating FDC for 08CF001...
Estimating FDC for 08CF003...
Estimating FDC for 08CG001...
Estimating FDC for 08CG004...
Estimating FDC for 08CG005...
Estimating FDC for 08DA009...
Estimating FDC for 08DA010...
Estimating FDC for 08DB001...
Estimating FDC for 08DB010...
Processed 110/1097 stations in 0.00 seconds per station
Estimating FDC for 08DB012...
Estimating FDC for 08DB013...
Estimating FDC for 08DB014...
Estimating FDC for 08DC006...
Estimating FDC for 08EB003...
Estimating FDC for 08EB004...
Estimating FDC for 08EB005...
Estimating FDC for 08EC001...
Estimating FDC for 08EC013...
Estimating FDC for 08ED001...
Processed 120/1097 stations in 0.00 seconds per station
Estimating FDC for 08ED002...
Estimating FDC for 08EE003...
Estimating FDC for 08EE004...
Estimating FDC for 08EE005...
Estimating FDC for 08EE008...
Estimating FDC for 08EE012...
Estimating FDC for 08EE013...
Estimating FDC for 08EE020...
Estimating FDC for 08EE025...
Estimating FDC for 08EE028...
Processed 130/1097 stations in 0.00 seconds per station
Estimating FDC for 08EF001...
Estimating FDC for 08EF005...
Estimating FDC for 08EG011...
Estimating FDC for 08EG012...
Estimating FDC for 08EG017...
Estimating FDC for 08FA002...
Estimating FDC for 08FB004...
Estimating FDC for 08FB005...
Estimating FDC for 08FB006...
Estimating FDC for 08FB007...
Processed 140/1097 stations in 0.00 seconds per station
Estimating FDC for 08FC003...
Estimating FDC for 08FC005...
Estimating FDC for 08FE003...
Estimating FDC for 08FF001...
Estimating FDC for 08FF002...
Estimating FDC for 08FF003...
Estimating FDC for 08FF006...
Estimating FDC for 08GA061...
Estimating FDC for 08GA065...
Estimating FDC for 08GA071...
Processed 150/1097 stations in 0.00 seconds per station
Estimating FDC for 08GA072...
Estimating FDC for 08GA075...
Estimating FDC for 08GA077...
Estimating FDC for 08GA079...
Estimating FDC for 08GB013...
Estimating FDC for 08GC008...
Estimating FDC for 08GD004...
Estimating FDC for 08GD005...
Estimating FDC for 08GD006...
Estimating FDC for 08GD007...
Processed 160/1097 stations in 0.00 seconds per station
Estimating FDC for 08GD008...
Estimating FDC for 08GE002...
Estimating FDC for 08GE003...
Estimating FDC for 08GF006...
Estimating FDC for 08GF007...
Estimating FDC for 08HA001...
Estimating FDC for 08HA003...
Estimating FDC for 08HA010...
Estimating FDC for 08HA016...
Estimating FDC for 08HA026...
Processed 170/1097 stations in 0.00 seconds per station
Estimating FDC for 08HA068...
Estimating FDC for 08HA069...
Estimating FDC for 08HA070...
Estimating FDC for 08HA072...
Estimating FDC for 08HB014...
Estimating FDC for 08HB032...
Estimating FDC for 08HB048...
Estimating FDC for 08HB069...
Estimating FDC for 08HB074...
Estimating FDC for 08HB075...
Processed 180/1097 stations in 0.00 seconds per station
Estimating FDC for 08HB086...
Estimating FDC for 08HB089...
Estimating FDC for 08HC002...
Estimating FDC for 08HD011...
Estimating FDC for 08HD015...
Estimating FDC for 08HD016...
Estimating FDC for 08HD023...
Estimating FDC for 08HE008...
Estimating FDC for 08HE009...
Estimating FDC for 08HE010...
Processed 190/1097 stations in 0.00 seconds per station
Estimating FDC for 08HF004...
Estimating FDC for 08HF005...
Estimating FDC for 08HF006...
Estimating FDC for 08HF007...
Estimating FDC for 08HF008...
Estimating FDC for 08HF012...
Estimating FDC for 08HF013...
Estimating FDC for 08JA014...
Estimating FDC for 08JB002...
Estimating FDC for 08JB003...
Processed 200/1097 stations in 0.00 seconds per station
Estimating FDC for 08JB012...
Estimating FDC for 08JD006...
Estimating FDC for 08JE001...
Estimating FDC for 08JE004...
Estimating FDC for 08JE005...
Estimating FDC for 08KA001...
Estimating FDC for 08KA004...
Estimating FDC for 08KA005...
Estimating FDC for 08KA007...
Estimating FDC for 08KA008...
Processed 210/1097 stations in 0.00 seconds per station
Estimating FDC for 08KA009...
Estimating FDC for 08KA013...
Estimating FDC for 08KB001...
Estimating FDC for 08KB003...
Estimating FDC for 08KB006...
Estimating FDC for 08KC001...
Estimating FDC for 08KC003...
Estimating FDC for 08KD001...
Estimating FDC for 08KD006...
Estimating FDC for 08KD007...
Processed 220/1097 stations in 0.00 seconds per station
Estimating FDC for 08KE009...
Estimating FDC for 08KE016...
Estimating FDC for 08KE024...
Estimating FDC for 08KF001...
Estimating FDC for 08KG001...
Estimating FDC for 08KG003...
Estimating FDC for 08KH001...
Estimating FDC for 08KH003...
Estimating FDC for 08KH006...
Estimating FDC for 08KH010...
Processed 230/1097 stations in 0.00 seconds per station
Estimating FDC for 08KH019...
Estimating FDC for 08KH022...
Estimating FDC for 08KH029...
Estimating FDC for 08KH030...
Estimating FDC for 08KH031...
Estimating FDC for 08LA001...
Estimating FDC for 08LA007...
Estimating FDC for 08LA008...
Estimating FDC for 08LA018...
Estimating FDC for 08LA027...
Processed 240/1097 stations in 0.00 seconds per station
Estimating FDC for 08LA028...
Estimating FDC for 08LB020...
Estimating FDC for 08LB024...
Estimating FDC for 08LB038...
Estimating FDC for 08LB047...
Estimating FDC for 08LB064...
Estimating FDC for 08LB069...
Estimating FDC for 08LB076...
Estimating FDC for 08LC040...
Estimating FDC for 08LD001...
Processed 250/1097 stations in 0.00 seconds per station
Estimating FDC for 08LE024...
Estimating FDC for 08LE027...
Estimating FDC for 08LE031...
Estimating FDC for 08LE075...
Estimating FDC for 08LE077...
Estimating FDC for 08LE094...
Estimating FDC for 08LE108...
Estimating FDC for 08LF051...
Estimating FDC for 08LF080...
Estimating FDC for 08LF081...
Processed 260/1097 stations in 0.00 seconds per station
Estimating FDC for 08LF084...
Estimating FDC for 08LF099...
Estimating FDC for 08LF100...
Estimating FDC for 08LG008...
Estimating FDC for 08LG016...
Estimating FDC for 08LG048...
Estimating FDC for 08LG055...
Estimating FDC for 08LG056...
Estimating FDC for 08LG066...
Estimating FDC for 08LG068...
Processed 270/1097 stations in 0.00 seconds per station
Estimating FDC for 08MA001...
Estimating FDC for 08MA002...
Estimating FDC for 08MA003...
Estimating FDC for 08MA006...
Estimating FDC for 08MB005...
Estimating FDC for 08MB006...
Estimating FDC for 08MB007...
Estimating FDC for 08MC045...
Estimating FDC for 08MD035...
Estimating FDC for 08ME023...
Processed 280/1097 stations in 0.00 seconds per station
Estimating FDC for 08ME025...
Estimating FDC for 08ME027...
Estimating FDC for 08ME028...
Estimating FDC for 08MF062...
Estimating FDC for 08MF065...
Estimating FDC for 08MF068...
Estimating FDC for 08MG001...
Estimating FDC for 08MG005...
Estimating FDC for 08MG013...
Estimating FDC for 08MG026...
Processed 290/1097 stations in 0.00 seconds per station
Estimating FDC for 08MH001...
Estimating FDC for 08MH006...
Estimating FDC for 08MH016...
Estimating FDC for 08MH018...
Estimating FDC for 08MH029...
Estimating FDC for 08MH056...
Estimating FDC for 08MH076...
Estimating FDC for 08MH103...
Estimating FDC for 08MH104...
Estimating FDC for 08MH141...
Processed 300/1097 stations in 0.00 seconds per station
Estimating FDC for 08MH147...
Estimating FDC for 08MH155...
Estimating FDC for 08MH166...
Estimating FDC for 08NA002...
Estimating FDC for 08NA006...
Estimating FDC for 08NA012...
Estimating FDC for 08NB005...
Estimating FDC for 08NB012...
Estimating FDC for 08NB014...
Estimating FDC for 08NB016...
Processed 310/1097 stations in 0.00 seconds per station
Estimating FDC for 08NB018...
Estimating FDC for 08NB019...
Estimating FDC for 08NC004...
Estimating FDC for 08ND012...
Estimating FDC for 08ND013...
Estimating FDC for 08ND018...
Estimating FDC for 08ND019...
Estimating FDC for 08NE006...
Estimating FDC for 08NE008...
Estimating FDC for 08NE021...
Processed 320/1097 stations in 0.00 seconds per station
Estimating FDC for 08NE039...
Estimating FDC for 08NE074...
Estimating FDC for 08NE077...
Estimating FDC for 08NE087...
Estimating FDC for 08NE110...
Estimating FDC for 08NE114...
Estimating FDC for 08NF001...
Estimating FDC for 08NF002...
Estimating FDC for 08NG012...
Estimating FDC for 08NG046...
Processed 330/1097 stations in 0.00 seconds per station
Estimating FDC for 08NG051...
Estimating FDC for 08NG065...
Estimating FDC for 08NG076...
Estimating FDC for 08NG077...
Estimating FDC for 08NG078...
Estimating FDC for 08NG086...
Estimating FDC for 08NH005...
Estimating FDC for 08NH006...
Estimating FDC for 08NH007...
Estimating FDC for 08NH016...
Processed 340/1097 stations in 0.00 seconds per station
Estimating FDC for 08NH032...
Estimating FDC for 08NH051...
Estimating FDC for 08NH084...
Estimating FDC for 08NH115...
Estimating FDC for 08NH119...
Estimating FDC for 08NH120...
Estimating FDC for 08NH130...
Estimating FDC for 08NH132...
Estimating FDC for 08NH138...
Estimating FDC for 08NJ013...
Processed 350/1097 stations in 0.00 seconds per station
Estimating FDC for 08NJ019...
Estimating FDC for 08NJ026...
Estimating FDC for 08NJ061...
Estimating FDC for 08NJ129...
Estimating FDC for 08NJ130...
Estimating FDC for 08NJ160...
Estimating FDC for 08NJ162...
Estimating FDC for 08NJ168...
Estimating FDC for 08NK002...
Estimating FDC for 08NK016...
Processed 360/1097 stations in 0.00 seconds per station
Estimating FDC for 08NK018...
Estimating FDC for 08NK020...
Estimating FDC for 08NK022...
Estimating FDC for 08NK026...
Estimating FDC for 08NL004...
Estimating FDC for 08NL007...
Estimating FDC for 08NL024...
Estimating FDC for 08NL036...
Estimating FDC for 08NL038...
Estimating FDC for 08NL050...
Processed 370/1097 stations in 0.00 seconds per station
Estimating FDC for 08NL069...
Estimating FDC for 08NL070...
Estimating FDC for 08NL071...
Estimating FDC for 08NL076...
Estimating FDC for 08NM133...
Estimating FDC for 08NM134...
Estimating FDC for 08NM137...
Estimating FDC for 08NM142...
Estimating FDC for 08NM146...
Estimating FDC for 08NM171...
Processed 380/1097 stations in 0.00 seconds per station
Estimating FDC for 08NM173...
Estimating FDC for 08NM174...
Estimating FDC for 08NM240...
Estimating FDC for 08NM241...
Estimating FDC for 08NM242...
Estimating FDC for 08NN002...
Estimating FDC for 08NN012...
Estimating FDC for 08NN013...
Estimating FDC for 08NN015...
Estimating FDC for 08NN019...
Processed 390/1097 stations in 0.00 seconds per station
Estimating FDC for 08NN021...
Estimating FDC for 08NN022...
Estimating FDC for 08NN023...
Estimating FDC for 08NN028...
Estimating FDC for 08NP001...
Estimating FDC for 08NP002...
Estimating FDC for 08NP004...
Estimating FDC for 08OA002...
Estimating FDC for 09AA006...
Estimating FDC for 09AA007...
Processed 400/1097 stations in 0.00 seconds per station
Estimating FDC for 09AA010...
Estimating FDC for 09AA012...
Estimating FDC for 09AA013...
Estimating FDC for 09AB008...
Estimating FDC for 09AB009...
Estimating FDC for 09AC001...
Estimating FDC for 09AC007...
Estimating FDC for 09AD001...
Estimating FDC for 09AE001...
Estimating FDC for 09AE003...
Processed 410/1097 stations in 0.00 seconds per station
Estimating FDC for 09AE004...
Estimating FDC for 09AE006...
Estimating FDC for 09AG003...
Estimating FDC for 10AA001...
Estimating FDC for 10AA002...
Estimating FDC for 10AA004...
Estimating FDC for 10AA005...
Estimating FDC for 10AB001...
Estimating FDC for 10AB003...
Estimating FDC for 10AC002...
Processed 420/1097 stations in 0.00 seconds per station
Estimating FDC for 10AC003...
Estimating FDC for 10AC004...
Estimating FDC for 10AC005...
Estimating FDC for 10AC006...
Estimating FDC for 10AD001...
Estimating FDC for 10AD002...
Estimating FDC for 10BA001...
Estimating FDC for 10BB001...
Estimating FDC for 10BB002...
Estimating FDC for 10BC001...
Processed 430/1097 stations in 0.00 seconds per station
Estimating FDC for 10BD001...
Estimating FDC for 10BE001...
Estimating FDC for 10BE004...
Estimating FDC for 10BE005...
Estimating FDC for 10BE006...
Estimating FDC for 10BE007...
Estimating FDC for 10BE009...
Estimating FDC for 10BE010...
Estimating FDC for 10BE011...
Estimating FDC for 10BE012...
Processed 440/1097 stations in 0.00 seconds per station
Estimating FDC for 10BE013...
Estimating FDC for 10CA001...
Estimating FDC for 10CB001...
Estimating FDC for 10CC002...
Estimating FDC for 10CD001...
Estimating FDC for 10CD003...
Estimating FDC for 10CD004...
Estimating FDC for 10CD005...
Estimating FDC for 10CD006...
Estimating FDC for 10DA001...
Processed 450/1097 stations in 0.00 seconds per station
Estimating FDC for 10EA002...
Estimating FDC for 10EA003...
Estimating FDC for 10EB001...
Estimating FDC for 10EB003...
Estimating FDC for 10EC001...
Estimating FDC for 10EC002...
Estimating FDC for 10ED001...
Estimating FDC for 10ED002...
Estimating FDC for 10ED003...
Estimating FDC for 10ED007...
Processed 460/1097 stations in 0.00 seconds per station
Estimating FDC for 10ED009...
Estimating FDC for 10FA002...
Estimating FDC for 10FB005...
Estimating FDC for 10GC003...
Estimating FDC for 12010000...
Estimating FDC for 12013500...
Estimating FDC for 12020000...
Estimating FDC for 12025000...
Estimating FDC for 12025700...
Estimating FDC for 12026150...
Processed 470/1097 stations in 0.00 seconds per station
Estimating FDC for 12026400...
Estimating FDC for 12027500...
Estimating FDC for 12031000...
Estimating FDC for 12035000...
Estimating FDC for 12035002...
Estimating FDC for 12035450...
Estimating FDC for 12036000...
Estimating FDC for 12036400...
Estimating FDC for 12036650...
Estimating FDC for 12037400...
Processed 480/1097 stations in 0.00 seconds per station
Estimating FDC for 12039005...
Estimating FDC for 12039300...
Estimating FDC for 12039500...
Estimating FDC for 12040500...
Estimating FDC for 12041200...
Estimating FDC for 12043000...
Estimating FDC for 12043163...
Estimating FDC for 12043300...
Estimating FDC for 12044900...
Estimating FDC for 12048000...
Processed 490/1097 stations in 0.00 seconds per station
Estimating FDC for 12054000...
Estimating FDC for 12056500...
Estimating FDC for 12058800...
Estimating FDC for 12060500...
Estimating FDC for 12069550...
Estimating FDC for 12073500...
Estimating FDC for 12076800...
Estimating FDC for 12079000...
Estimating FDC for 12080010...
Estimating FDC for 12082500...
Processed 500/1097 stations in 0.00 seconds per station
Estimating FDC for 12083000...
Estimating FDC for 12087000...
Estimating FDC for 12088000...
Estimating FDC for 12090500...
Estimating FDC for 12092000...
Estimating FDC for 12093500...
Estimating FDC for 12094000...
Estimating FDC for 12095000...
Estimating FDC for 12096500...
Estimating FDC for 12097500...
Processed 510/1097 stations in 0.00 seconds per station
Estimating FDC for 12097850...
Estimating FDC for 12098500...
Estimating FDC for 12099200...
Estimating FDC for 12100000...
Estimating FDC for 12100490...
Estimating FDC for 12100496...
Estimating FDC for 12101500...
Estimating FDC for 12102190...
Estimating FDC for 12103380...
Estimating FDC for 12104500...
Processed 520/1097 stations in 0.00 seconds per station
Estimating FDC for 12108500...
Estimating FDC for 12113000...
Estimating FDC for 12113347...
Estimating FDC for 12114500...
Estimating FDC for 12115000...
Estimating FDC for 12115500...
Estimating FDC for 12115700...
Estimating FDC for 12115800...
Estimating FDC for 12117000...
Estimating FDC for 12120600...
Processed 530/1097 stations in 0.00 seconds per station
Estimating FDC for 12121600...
Estimating FDC for 12122500...
Estimating FDC for 12125200...
Estimating FDC for 12127100...
Estimating FDC for 12134500...
Estimating FDC for 12137290...
Estimating FDC for 12137800...
Estimating FDC for 12141300...
Estimating FDC for 12142000...
Estimating FDC for 12143400...
Processed 540/1097 stations in 0.00 seconds per station
Estimating FDC for 12143600...
Estimating FDC for 12144000...
Estimating FDC for 12144500...
Estimating FDC for 12145500...
Estimating FDC for 12147500...
Estimating FDC for 12147600...
Estimating FDC for 12149000...
Estimating FDC for 12150800...
Estimating FDC for 12155300...
Estimating FDC for 12157250...
Processed 550/1097 stations in 0.00 seconds per station
Estimating FDC for 12158010...
Estimating FDC for 12158040...
Estimating FDC for 12167000...
Estimating FDC for 12175500...
Estimating FDC for 12178100...
Estimating FDC for 12179900...
Estimating FDC for 12181100...
Estimating FDC for 12182500...
Estimating FDC for 12185300...
Estimating FDC for 12186000...
Processed 560/1097 stations in 0.00 seconds per station
Estimating FDC for 12189500...
Estimating FDC for 12190710...
Estimating FDC for 12190718...
Estimating FDC for 12192700...
Estimating FDC for 12193400...
Estimating FDC for 12193500...
Estimating FDC for 12200500...
Estimating FDC for 12201500...
Estimating FDC for 12201950...
Estimating FDC for 12201960...
Processed 570/1097 stations in 0.00 seconds per station
Estimating FDC for 12202300...
Estimating FDC for 12202310...
Estimating FDC for 12205000...
Estimating FDC for 12206900...
Estimating FDC for 12207750...
Estimating FDC for 12207850...
Estimating FDC for 12208000...
Estimating FDC for 12209000...
Estimating FDC for 12209490...
Estimating FDC for 12210000...
Processed 580/1097 stations in 0.00 seconds per station
Estimating FDC for 12210500...
Estimating FDC for 12210700...
Estimating FDC for 12210900...
Estimating FDC for 12213100...
Estimating FDC for 12301300...
Estimating FDC for 12302055...
Estimating FDC for 12303100...
Estimating FDC for 12303500...
Estimating FDC for 12304040...
Estimating FDC for 12323600...
Processed 590/1097 stations in 0.00 seconds per station
Estimating FDC for 12323670...
Estimating FDC for 12323700...
Estimating FDC for 12323710...
Estimating FDC for 12323720...
Estimating FDC for 12323760...
Estimating FDC for 12323770...
Estimating FDC for 12323840...
Estimating FDC for 12323850...
Estimating FDC for 12324200...
Estimating FDC for 12324400...
Processed 600/1097 stations in 0.00 seconds per station
Estimating FDC for 12324590...
Estimating FDC for 12324680...
Estimating FDC for 12330000...
Estimating FDC for 12331500...
Estimating FDC for 12331800...
Estimating FDC for 12331900...
Estimating FDC for 12332000...
Estimating FDC for 12334510...
Estimating FDC for 12334550...
Estimating FDC for 12335100...
Processed 610/1097 stations in 0.00 seconds per station
Estimating FDC for 12335500...
Estimating FDC for 12338300...
Estimating FDC for 12339450...
Estimating FDC for 12340000...
Estimating FDC for 12340500...
Estimating FDC for 12344000...
Estimating FDC for 12351200...
Estimating FDC for 12352500...
Estimating FDC for 12353000...
Estimating FDC for 12354000...
Processed 620/1097 stations in 0.00 seconds per station
Estimating FDC for 12354500...
Estimating FDC for 12358500...
Estimating FDC for 12365000...
Estimating FDC for 12366000...
Estimating FDC for 12366080...
Estimating FDC for 12369200...
Estimating FDC for 12370000...
Estimating FDC for 12374250...
Estimating FDC for 12375900...
Estimating FDC for 12377150...
Processed 630/1097 stations in 0.00 seconds per station
Estimating FDC for 12383500...
Estimating FDC for 12388200...
Estimating FDC for 12388400...
Estimating FDC for 12389500...
Estimating FDC for 12390700...
Estimating FDC for 12391400...
Estimating FDC for 12392155...
Estimating FDC for 12392300...
Estimating FDC for 12396500...
Estimating FDC for 12396900...
Processed 640/1097 stations in 0.00 seconds per station
Estimating FDC for 12398000...
Estimating FDC for 12400900...
Estimating FDC for 12408500...
Estimating FDC for 12409000...
Estimating FDC for 12411000...
Estimating FDC for 12413000...
Estimating FDC for 12413125...
Estimating FDC for 12413130...
Estimating FDC for 12413210...
Estimating FDC for 12413360...
Processed 650/1097 stations in 0.00 seconds per station
Estimating FDC for 12413370...
Estimating FDC for 12413445...
Estimating FDC for 12413470...
Estimating FDC for 12413500...
Estimating FDC for 12413860...
Estimating FDC for 12413875...
Estimating FDC for 12414500...
Estimating FDC for 12415350...
Estimating FDC for 12416000...
----- stderr -----
2025-07-04 12:03:48.074917: W external/xla/xla/service/platform_util.cc:220] unable to create StreamExecutor for CUDA:0: : CUDA_ERROR_OUT_OF_MEMORY: out of memory
------------------

[31m---------------------------------------------------------------------------[39m
[31mXlaRuntimeError[39m                           Traceback (most recent call last)
    [31m[... skipping hidden 1 frame][39m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/xla_bridge.py:828[39m, in [36m_init_backend[39m[34m(platform)[39m
[32m    827[39m logger.debug([33m"[39m[33mInitializing backend [39m[33m'[39m[38;5;132;01m%s[39;00m[33m'[39m[33m"[39m, platform)
[32m--> [39m[32m828[39m backend = [43mregistration[49m[43m.[49m[43mfactory[49m[43m([49m[43m)[49m
[32m    829[39m [38;5;66;03m# TODO(skye): consider raising more descriptive errors directly from backend[39;00m
[32m    830[39m [38;5;66;03m# factories instead of returning None.[39;00m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/xla_bridge.py:518[39m, in [36mregister_plugin.<locals>.factory[39m[34m()[39m
[32m    517[39m [38;5;28;01mif[39;00m distributed.global_state.client [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[32m--> [39m[32m518[39m   [38;5;28;01mreturn[39;00m [43mxla_client[49m[43m.[49m[43mmake_c_api_client[49m[43m([49m[43mplugin_name[49m[43m,[49m[43m [49m[43mupdated_options[49m[43m,[49m[43m [49m[38;5;28;43;01mNone[39;49;00m[43m)[49m
[32m    520[39m distribute_options = {
[32m    521[39m     [33m'[39m[33mnode_id[39m[33m'[39m: distributed.global_state.process_id,
[32m    522[39m     [33m'[39m[33mnum_nodes[39m[33m'[39m: distributed.global_state.num_processes,
[32m    523[39m }

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jaxlib/xla_client.py:153[39m, in [36mmake_c_api_client[39m[34m(plugin_name, options, distributed_client)[39m
[32m    152[39m   options = {}
[32m--> [39m[32m153[39m [38;5;28;01mreturn[39;00m [43m_xla[49m[43m.[49m[43mget_c_api_client[49m[43m([49m[43mplugin_name[49m[43m,[49m[43m [49m[43moptions[49m[43m,[49m[43m [49m[43mdistributed_client[49m[43m)[49m

[31mXlaRuntimeError[39m: INTERNAL: no supported devices found for platform CUDA

During handling of the above exception, another exception occurred:

[31mRuntimeError[39m                              Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[16][39m[32m, line 9[39m
[32m      7[39m [38;5;28mprint[39m([33mf[39m[33m'[39m[33mEstimating FDC for [39m[38;5;132;01m{[39;00mstn[38;5;132;01m}[39;00m[33m...[39m[33m'[39m)
[32m      8[39m runner = FDCEstimatorRunner(stn, context, methods, k_nearest, target_cols, ESTIMATOR_CLASSES)
[32m----> [39m[32m9[39m [43mrunner[49m[43m.[49m[43mrun_selected[49m[43m([49m[43m)[49m
[32m     10[39m processed.append(stn)
[32m     11[39m [38;5;28;01mif[39;00m [38;5;28mlen[39m(processed) % [32m10[39m == [32m0[39m:

[36mCell[39m[36m [39m[32mIn[10][39m[32m, line 61[39m, in [36mFDCEstimatorRunner.run_selected[39m[34m(self)[39m
[32m     59[39m     [38;5;28mself[39m.data.k_nearest = [38;5;28mself[39m.k_nearest
[32m     60[39m     [38;5;28mself[39m.data.parametric_target_cols = [38;5;28mself[39m.parametric_target_cols
[32m---> [39m[32m61[39m     [38;5;28;43mself[39;49m[43m.[49m[43m_load_reference_distributions[49m[43m([49m[43m)[49m
[32m     62[39m [38;5;28;01mtry[39;00m:
[32m     63[39m     EstimatorClass = [38;5;28mself[39m.ESTIMATOR_CLASSES[method]

[36mCell[39m[36m [39m[32mIn[10][39m[32m, line 40[39m, in [36mFDCEstimatorRunner._load_reference_distributions[39m[34m(self)[39m
[32m     39[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34m_load_reference_distributions[39m([38;5;28mself[39m):
[32m---> [39m[32m40[39m     [38;5;28mself[39m.kde = [43mKDEEstimator[49m[43m([49m[38;5;28;43mself[39;49m[43m.[49m[43mdata[49m[43m.[49m[43mbaseline_log_grid[49m[43m,[49m[43m [49m[38;5;28;43mself[39;49m[43m.[49m[43mdata[49m[43m.[49m[43mlog_dx[49m[43m)[49m
[32m     41[39m     [38;5;28mself[39m.baseline_pmf, [38;5;28mself[39m.baseline_pdf = [38;5;28mself[39m.data.baseline_pmf, [38;5;28mself[39m.data.baseline_pdf
[32m     42[39m     [38;5;28mself[39m.ctx.baseline_pmf = [38;5;28mself[39m.baseline_pmf

[36mFile [39m[32m~/code/distribution_estimation/docs/notebooks/kde_estimator.py:91[39m, in [36mKDEEstimator.__init__[39m[34m(self, log_grid, dx, cache)[39m
[32m     90[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34m__init__[39m([38;5;28mself[39m, log_grid, dx, cache=[38;5;28;01mNone[39;00m):
[32m---> [39m[32m91[39m     [38;5;28mself[39m.log_grid = [43mjnp[49m[43m.[49m[43masarray[49m[43m([49m[43mlog_grid[49m[43m,[49m[43m [49m[43mdtype[49m[43m=[49m[43mjnp[49m[43m.[49m[43mfloat32[49m[43m)[49m
[32m     92[39m     [38;5;28mself[39m.dx = jnp.asarray(dx, dtype=jnp.float32)

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/numpy/array.py:383[39m, in [36masarray[39m[34m(a, dtype, order, copy, device)[39m
[32m    381[39m [38;5;28;01mif[39;00m dtype [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:
[32m    382[39m   dtype = dtypes.canonicalize_dtype(dtype, allow_extended_dtype=[38;5;28;01mTrue[39;00m)  [38;5;66;03m# type: ignore[assignment][39;00m
[32m--> [39m[32m383[39m [38;5;28;01mreturn[39;00m [43marray[49m[43m([49m[43ma[49m[43m,[49m[43m [49m[43mdtype[49m[43m=[49m[43mdtype[49m[43m,[49m[43m [49m[43mcopy[49m[43m=[49m[38;5;28;43mbool[39;49m[43m([49m[43mcopy[49m[43m)[49m[43m,[49m[43m [49m[43morder[49m[43m=[49m[43morder[49m[43m,[49m[43m [49m[43mdevice[49m[43m=[49m[43mdevice[49m[43m)[49m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/numpy/array.py:268[39m, in [36marray[39m[34m(object, dtype, copy, order, ndmin, device)[39m
[32m    266[39m [38;5;28;01melse[39;00m:
[32m    267[39m   [38;5;28;01mraise[39;00m [38;5;167;01mTypeError[39;00m([33mf[39m[33m"[39m[33mUnexpected input type for array: [39m[38;5;132;01m{[39;00m[38;5;28mtype[39m([38;5;28mobject[39m)[38;5;132;01m}[39;00m[33m"[39m)
[32m--> [39m[32m268[39m out_array: Array = [43mlax[49m[43m.[49m[43m_convert_element_type[49m[43m([49m
[32m    269[39m [43m    [49m[43mout[49m[43m,[49m[43m [49m[43mdtype[49m[43m,[49m[43m [49m[43mweak_type[49m[43m=[49m[43mweak_type[49m[43m,[49m[43m [49m[43msharding[49m[43m=[49m[43msharding[49m[43m)[49m
[32m    270[39m [38;5;28;01mif[39;00m ndmin > np.ndim(out_array):
[32m    271[39m   out_array = lax.expand_dims(out_array, [38;5;28mrange[39m(ndmin - np.ndim(out_array)))

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/lax/lax.py:1726[39m, in [36m_convert_element_type[39m[34m(operand, new_dtype, weak_type, sharding, warn_on_complex_to_real_cast)[39m
[32m   1724[39m   [38;5;28;01mreturn[39;00m operand
[32m   1725[39m [38;5;28;01melse[39;00m:
[32m-> [39m[32m1726[39m   [38;5;28;01mreturn[39;00m [43mconvert_element_type_p[49m[43m.[49m[43mbind[49m[43m([49m
[32m   1727[39m [43m      [49m[43moperand[49m[43m,[49m[43m [49m[43mnew_dtype[49m[43m=[49m[43mnew_dtype[49m[43m,[49m[43m [49m[43mweak_type[49m[43m=[49m[38;5;28;43mbool[39;49m[43m([49m[43mweak_type[49m[43m)[49m[43m,[49m
[32m   1728[39m [43m      [49m[43msharding[49m[43m=[49m[43msharding[49m[43m)[49m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/core.py:536[39m, in [36mPrimitive.bind[39m[34m(self, *args, **params)[39m
[32m    534[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mbind[39m([38;5;28mself[39m, *args, **params):
[32m    535[39m   args = args [38;5;28;01mif[39;00m [38;5;28mself[39m.skip_canonicalization [38;5;28;01melse[39;00m [38;5;28mmap[39m(canonicalize_value, args)
[32m--> [39m[32m536[39m   [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[43m.[49m[43m_true_bind[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mparams[49m[43m)[49m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/core.py:552[39m, in [36mPrimitive._true_bind[39m[34m(self, *args, **params)[39m
[32m    550[39m trace_ctx.set_trace(eval_trace)
[32m    551[39m [38;5;28;01mtry[39;00m:
[32m--> [39m[32m552[39m   [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[43m.[49m[43mbind_with_trace[49m[43m([49m[43mprev_trace[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[32m    553[39m [38;5;28;01mfinally[39;00m:
[32m    554[39m   trace_ctx.set_trace(prev_trace)

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/lax/lax.py:4902[39m, in [36m_convert_element_type_bind_with_trace[39m[34m(trace, args, params)[39m
[32m   4900[39m [38;5;28;01mdef[39;00m[38;5;250m [39m[34m_convert_element_type_bind_with_trace[39m(trace, args, params):
[32m   4901[39m   sharding = params[[33m'[39m[33msharding[39m[33m'[39m]
[32m-> [39m[32m4902[39m   operand = [43mcore[49m[43m.[49m[43mPrimitive[49m[43m.[49m[43mbind_with_trace[49m[43m([49m[43mconvert_element_type_p[49m[43m,[49m[43m [49m[43mtrace[49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m
[32m   4903[39m   [38;5;28;01mif[39;00m sharding [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m [38;5;129;01mand[39;00m sharding._is_concrete:
[32m   4904[39m     [38;5;28;01mwith[39;00m core.set_current_trace(trace):

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/core.py:562[39m, in [36mPrimitive.bind_with_trace[39m[34m(self, trace, args, params)[39m
[32m    559[39m   [38;5;28;01mwith[39;00m set_current_trace(trace):
[32m    560[39m     [38;5;28;01mreturn[39;00m [38;5;28mself[39m.to_lojax(*args, **params)  [38;5;66;03m# type: ignore[39;00m
[32m--> [39m[32m562[39m [38;5;28;01mreturn[39;00m [43mtrace[49m[43m.[49m[43mprocess_primitive[49m[43m([49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43margs[49m[43m,[49m[43m [49m[43mparams[49m[43m)[49m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/core.py:1066[39m, in [36mEvalTrace.process_primitive[39m[34m(self, primitive, args, params)[39m
[32m   1064[39m args = [38;5;28mmap[39m(full_lower, args)
[32m   1065[39m check_eval_args(args)
[32m-> [39m[32m1066[39m [38;5;28;01mreturn[39;00m [43mprimitive[49m[43m.[49m[43mimpl[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mparams[49m[43m)[49m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/dispatch.py:91[39m, in [36mapply_primitive[39m[34m(prim, *args, **params)[39m
[32m     89[39m prev = lib.jax_jit.swap_thread_local_state_disable_jit([38;5;28;01mFalse[39;00m)
[32m     90[39m [38;5;28;01mtry[39;00m:
[32m---> [39m[32m91[39m   outs = [43mfun[49m[43m([49m[43m*[49m[43margs[49m[43m)[49m
[32m     92[39m [38;5;28;01mfinally[39;00m:
[32m     93[39m   lib.jax_jit.swap_thread_local_state_disable_jit(prev)

    [31m[... skipping hidden 14 frame][39m

[36mFile [39m[32m~/code/data_analysis/lib/python3.12/site-packages/jax/_src/xla_bridge.py:758[39m, in [36mbackends[39m[34m()[39m
[32m    756[39m       [38;5;28;01melse[39;00m:
[32m    757[39m         err_msg += [33m"[39m[33m (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)[39m[33m"[39m
[32m--> [39m[32m758[39m       [38;5;28;01mraise[39;00m [38;5;167;01mRuntimeError[39;00m(err_msg)
[32m    760[39m [38;5;28;01massert[39;00m _default_backend [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m
[32m    761[39m [38;5;28;01mif[39;00m [38;5;129;01mnot[39;00m config.jax_platforms.value:

[31mRuntimeError[39m: Unable to initialize backend 'cuda': INTERNAL: no supported devices found for platform CUDA (you may need to uninstall the failing plugin package, or set JAX_PLATFORMS=cpu to skip this backend.)

